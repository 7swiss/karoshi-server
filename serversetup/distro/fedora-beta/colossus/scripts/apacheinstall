#!/bin/bash
#softwareinstall
source /opt/karoshi/serversetup/variables/distro
source /opt/karoshi/serversetup/distro/$DISTROCHOICE/colossus/software

xterm -geometry 100x20 -bg white -fg black -e yum -y install $APACHESOFTWARE

#######################
#allow htaccess in certain folders
#######################

if [ -f $HTTPDCONFPATH ]
then
clear
else
HTTPDCONFPATH=$HTTPDCONFPATH2
fi
DIRCOUNT=`grep -c /var/www/html/internal $HTTPDCONFPATH`
if [ $DIRCOUNT = 0 ]
then
echo '<'Directory '"'/var/www/html/internal'"''>' >> $HTTPDCONFPATH
echo AllowOverride Limit >> $HTTPDCONFPATH
echo '<'/Directory'>' >> $HTTPDCONFPATH 
fi

DIRCOUNT=`grep -c /var/www/html/squirrelmail $HTTPDCONFPATH`
if [ $DIRCOUNT = 0 ]
then
echo '<'Directory '"'/var/www/html/squirrelmail'"''>' >> $HTTPDCONFPATH
echo AllowOverride Limit >> $HTTPDCONFPATH
echo '<'/Directory'>' >> $HTTPDCONFPATH 
fi

DIRCOUNT=`grep -c /var/www/html/moodle $HTTPDCONFPATH`
if [ $DIRCOUNT = 0 ]
then
echo '<'Directory '"'/var/www/html/moodle'"''>' >> $HTTPDCONFPATH
echo AllowOverride Limit >> $HTTPDCONFPATH
echo '<'/Directory'>' >> $HTTPDCONFPATH 
fi

DIRCOUNT=`grep -c /var/www/html/sos $HTTPDCONFPATH`
if [ $DIRCOUNT = 0 ]
then
echo '<'Directory '"'/var/www/html/sos'"''>' >> $HTTPDCONFPATH
echo AllowOverride All >> $HTTPDCONFPATH
echo '<'/Directory'>' >> $HTTPDCONFPATH
/etc/init.d/$APACHEVER restart
fi

if [ $DIRCOUNT = 0 ]
then
echo '<'Directory '"'/var/www/html/egroupware'"''>' >> $HTTPDCONFPATH
echo AllowOverride All >> $HTTPDCONFPATH
echo '<'/Directory'>' >> $HTTPDCONFPATH 
fi
